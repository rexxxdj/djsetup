$(document).ready(function(){$('body').append('<div id="page-loading-blocs-notifaction"></div>');$('.bloc-fill-screen').css('height',$(window).height()+'px');$('#scroll-hero').click(function(event){event.preventDefault();$('html,body').animate({scrollTop:$('#scroll-hero').closest('.bloc').height()},'slow')});extraNavFuncs();setUpSpecialNavs();setUpDropdownSubs();setUpLightBox();setUpVisibilityToggle();addSwipeSupport();addKeyBoardSupport()});$(window).load(function(){setFillScreenBlocHeight();animateWhenVisible();$('#page-loading-blocs-notifaction').remove()}).resize(function(){setFillScreenBlocHeight()});function setUpSpecialNavs(){$('.navbar-toggle').click(function(e){var targetNav=$(this).closest('nav');var targetMenu=targetNav.find('ul.site-navigation');var newMenu=targetMenu.clone();if(targetMenu.parent().hasClass('nav-special')){e.stopPropagation();if(!$(this).hasClass('selected-nav')){$(this).addClass('selected-nav');var navClasses=targetNav.attr('class').replace('navbar','').replace('row','');var menuClasses=targetMenu.parent().attr('class').replace('navbar-collapse','').replace('collapse','');if($('.content-tint').length=-1){$('body').append('<div class="content-tint"></div>')}newMenu.insertBefore('.page-container').wrap('<div class="blocsapp-special-menu '+navClasses+'"><blocsnav class="'+menuClasses+'">');$('blocsnav').prepend('<a class="close-special-menu animated fadeIn" style="animation-delay:0.5s;"><div class="close-icon"></div></a>');animateNavItems();setTimeout(function(){$('.blocsapp-special-menu blocsnav').addClass('open');$('.content-tint').addClass('on');$('body').addClass('lock-scroll')},10)}else{$('.blocsapp-special-menu blocsnav').removeClass('open');$('.selected-nav').removeClass('selected-nav');setTimeout(function(){$('.blocsapp-special-menu').remove();$('body').removeClass('lock-scroll');$('.selected-nav').removeClass('selected-nav')},300)}}});$('body').on("mousedown touchstart",".content-tint, .close-special-menu",function(e){$('.content-tint').removeClass('on');$('.selected-nav').click();setTimeout(function(){$('.content-tint').remove()},10)}).on("click",".blocsapp-special-menu a",function(e){if(!$(e.target).closest('.dropdown-toggle').length){$('.close-special-menu').mousedown()}});function animateNavItems(){var animationStyle='fadeInRight';var delay=0;var increaseVal=60;if($('.blocsapp-special-menu blocsnav').hasClass('fullscreen-nav')){animationStyle='fadeIn';increaseVal=100}else if($('.blocsapp-special-menu').hasClass('nav-invert')){animationStyle='fadeInLeft'}$('.blocsapp-special-menu blocsnav li').each(function(){if($(this).parent().hasClass('dropdown-menu')){$(this).addClass('animated fadeIn')}else{delay+=increaseVal;$(this).attr('style','animation-delay:'+delay+'ms').addClass('animated '+animationStyle)}})}}function extraNavFuncs(){$(".site-navigation a").click(function(e){if(!$(e.target).closest('.dropdown-toggle').length){$(".navbar-collapse").collapse('hide')}});$("a.dropdown-toggle").click(function(e){$(this).parent().addClass('target-open-menu');$(this).closest('.dropdown-menu').find('.dropdown.open').each(function(i){if(!$(this).hasClass('target-open-menu')){$(this).removeClass('open')}});$('.target-open-menu').removeClass('target-open-menu')})}function setFillScreenBlocHeight(){$('.bloc-fill-screen').each(function(i){var parentFillDiv=$(this);window.fillBodyHeight=0;$(this).find('.container').each(function(i){fillPadding=parseInt($(this).css('padding-top'))*2 if(parentFillDiv.hasClass('bloc-group')){fillBodyHeight=fillPadding+$(this).outerHeight()+50}else{fillBodyHeight=fillBodyHeight+fillPadding+$(this).outerHeight()+50}});$(this).css('height',(getFillHeight())+'px')})}function getFillHeight(){var H=$(window).height();if(H<fillBodyHeight){H=fillBodyHeight+100}return H}function scrollToTarget(D){if(D==1){D=0}else if(D==2){D=$(document).height()}else{D=$(D).offset().top;if($('.sticky-nav').length){D=D-$('.sticky-nav').height()}}$('html,body').animate({scrollTop:D},'slow');$(".navbar-collapse").collapse('hide')}$(function(){$('[data-toggle="tooltip"]').tooltip()})function animateWhenVisible(){hideAll();inViewCheck();$(window).scroll(function(){inViewCheck();scrollToTopView();stickyNavToggle()})};function setUpDropdownSubs(){$('ul.dropdown-menu [data-toggle=dropdown]').on('click',function(event){event.preventDefault();event.stopPropagation();$(this).parent().siblings().removeClass('open');$(this).parent().toggleClass('open');var targetMenu=$(this).parent().children('.dropdown-menu');var leftVal=targetMenu.offset().left+targetMenu.width();if(leftVal>$(window).width()){targetMenu.addClass('dropmenu-flow-right')}})}function stickyNavToggle(){var V=0;var C="sticky";if($('.sticky-nav').hasClass('fill-bloc-top-edge')){var heroBackgroundColor=$('.fill-bloc-top-edge.sticky-nav').parent().css('background-color');if(heroBackgroundColor=="rgba(0, 0, 0, 0)"){heroBackgroundColor='#FFFFFF'}$('.sticky-nav').css('background',heroBackgroundColor);V=$('.sticky-nav').height();C="sticky animated fadeInDown"}if($(window).scrollTop()>V){$('.sticky-nav').addClass(C);if(C=="sticky"){$('.page-container').css('padding-top',$('.sticky-nav').height())}}else{$('.sticky-nav').removeClass(C).removeAttr('style');$('.page-container').removeAttr('style')}}function hideAll(){$('.animated').each(function(i){if(!$(this).closest('.hero').length){$(this).removeClass('animated').addClass('hideMe')}})}function inViewCheck(){$($(".hideMe").get().reverse()).each(function(i){var target=jQuery(this);var a=target.offset().top+target.height();var b=$(window).scrollTop()+$(window).height();if(target.height()>$(window).height()){a=target.offset().top}if(a<b){var objectClass=target.attr('class').replace('hideMe','animated');target.css('visibility','hidden').removeAttr('class');setTimeout(function(){target.attr('class',objectClass).css('visibility','visible')},0.01)}})};function scrollToTopView(){if($(window).scrollTop()>$(window).height()/3){if(!$('.scrollToTop').hasClass('showScrollTop')){$('.scrollToTop').addClass('showScrollTop')}}else{$('.scrollToTop').removeClass('showScrollTop')}};function setUpVisibilityToggle(){$(document).on('click','[data-toggle-visibility]',function(e){e.preventDefault();var targetID=$(this).attr('data-toggle-visibility');if(targetID.indexOf(',')!=-1){var targeArray=targetID.split(',');$.each(targeArray,function(i){toggleVisibility($('#'+targeArray[i]))})}else{toggleVisibility($('#'+targetID))}function toggleVisibility(T){if(T.is('img')){T.toggle()}else{T.slideToggle()}}})}function setUpLightBox(){window.targetLightbox;$(document).on('click','[data-lightbox]',function(e){e.preventDefault();targetLightbox=$(this);var lightBoxPath=targetLightbox.attr('data-lightbox');var lightBoxAutoPlay=targetLightbox.attr('data-autoplay');var captionData='<p class="lightbox-caption">'+targetLightbox.attr('data-caption')+'</p>';var galleryID='no-gallery-set';var lightBoxFrame=targetLightbox.attr('data-frame');if(targetLightbox.attr('data-gallery-id')){galleryID=targetLightbox.attr('data-gallery-id')}if(!targetLightbox.attr('data-caption')){captionData=''}var autoplay="";if(lightBoxAutoPlay==1){autoplay="autoplay"}var customModal=$('<div id="lightbox-modal" class="modal fade"><div class="modal-dialog"><div class="modal-content '+lightBoxFrame+' blocs-lb-container"><button id="blocs-lightbox-close-btn" type="button" class="close close-lightbox" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><div class="modal-body"><a href="#" class="prev-lightbox" aria-label="prev"><span class="fa fa-chevron-left"></span></a><a href="#" class="next-lightbox" aria-label="next"><span class="fa fa-chevron-right"></span></a><img id="lightbox-image" class="img-responsive" src="'+lightBoxPath+'"><div id="lightbox-video-container" class="embed-responsive embed-responsive-16by9"><video controls '+autoplay+' class="embed-responsive-item"><source id="lightbox-video" src="'+lightBoxPath+'" type="video/mp4"></video></div>'+captionData+'</div></div></div></div>');$('body').append(customModal);if(lightBoxFrame=="fullscreen-lb"){$('#lightbox-modal').addClass('fullscreen-modal').append('<a class="close-full-screen-modal animated fadeIn" style="animation-delay:0.5s;" onclick="$(\'#lightbox-modal\').modal(\'hide\');"><div class="close-icon"></div></a>');$('#blocs-lightbox-close-btn').remove()}if(lightBoxPath.substring(lightBoxPath.length-4)==".mp4"){$('#lightbox-image, .lightbox-caption').hide();$('#lightbox-video-container').show()}else{$('#lightbox-image,.lightbox-caption').show();$('#lightbox-video-container').hide()}$('#lightbox-modal').modal('show');if(galleryID=='no-gallery-set'){if($('a[data-lightbox]').index(targetLightbox)==0){$('.prev-lightbox').hide()}if($('a[data-lightbox]').index(targetLightbox)==$('a[data-lightbox]').length-1){$('.next-lightbox').hide()}}else{if($('a[data-gallery-id="'+galleryID+'"]').index(targetLightbox)==0){$('.prev-lightbox').hide()}if($('a[data-gallery-id="'+galleryID+'"]').index(targetLightbox)==$('a[data-gallery-id="'+galleryID+'"]').length-1){$('.next-lightbox').hide()}}addLightBoxSwipeSupport()}).on('hidden.bs.modal','#lightbox-modal',function(){$('#lightbox-modal').remove()})$(document).on('click','.next-lightbox, .prev-lightbox',function(e){e.preventDefault();var galleryID='no-gallery-set';var idx=$('a[data-lightbox]').index(targetLightbox);var next=$('a[data-lightbox]').eq(idx+1)if(targetLightbox.attr('data-gallery-id')){galleryID=targetLightbox.attr('data-gallery-id');idx=$('a[data-gallery-id="'+galleryID+'"]').index(targetLightbox);next=$('a[data-gallery-id="'+galleryID+'"]').eq(idx+1)}if($(this).hasClass('prev-lightbox')){next=$('a[data-gallery-id="'+galleryID+'"]').eq(idx-1)if(galleryID=='no-gallery-set'){next=$('a[data-lightbox]').eq(idx-1)}}var nextContentPath=next.attr('data-lightbox');if(nextContentPath.substring(nextContentPath.length-4)==".mp4"){var lightBoxAutoPlay=next.attr('data-autoplay');var autoplay="";if(lightBoxAutoPlay==1){autoplay="autoplay"}$('#lightbox-image, .lightbox-caption').hide();$('#lightbox-video-container').show().html('<video controls '+autoplay+' class="embed-responsive-item"><source id="lightbox-video" src="'+nextContentPath+'" type="video/mp4"></video>')}else{$('#lightbox-image').attr('src',nextContentPath).show();$('.lightbox-caption').html(next.attr('data-caption')).show();$('#lightbox-video-container').hide()}targetLightbox=next;$('.next-lightbox, .prev-lightbox').hide();if(galleryID=='no-gallery-set'){if($('a[data-lightbox]').index(next)!=$('a[data-lightbox]').length-1){$('.next-lightbox').show()}if($('a[data-lightbox]').index(next)>0){$('.prev-lightbox').show()}}else{if($('a[data-gallery-id="'+galleryID+'"]').index(next)!=$('a[data-gallery-id="'+galleryID+'"]').length-1){$('.next-lightbox').show()}if($('a[data-gallery-id="'+galleryID+'"]').index(next)>0){$('.prev-lightbox').show()}}})}function addSwipeSupport(){if($(".carousel-inner").length){$(".carousel-inner").swipe({swipeLeft:function(event,direction,distance,duration,fingerCount){$(this).parent().carousel('next')},swipeRight:function(){$(this).parent().carousel('prev')},threshold:0})}}function addKeyBoardSupport(){$(window).keydown(function(evt){if(evt.which==37){if($('.prev-lightbox').is(':visible')){$('.prev-lightbox').click()}}else if(evt.which==39){if($('.next-lightbox').is(':visible')){$('.next-lightbox').click()}}})}function addLightBoxSwipeSupport(){if($("#lightbox-image").length){$("#lightbox-image").swipe({swipeLeft:function(event,direction,distance,duration,fingerCount){if($('.next-lightbox').is(':visible')){$('.next-lightbox').click()}},swipeRight:function(){if($('.prev-lightbox').is(':visible')){$('.prev-lightbox').click()}},threshold:0})}}